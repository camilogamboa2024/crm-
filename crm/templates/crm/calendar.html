{% extends "crm/base.html" %}

{% block page_title %}Calendario de Flota{% endblock %}
{% block page_subtitle %}Visualiza la ocupaci√≥n de reservas en el mes.{% endblock %}
{% block breadcrumbs %}
  <li class="breadcrumb-item active" aria-current="page">Calendario</li>
{% endblock %}

{% block content %}
  <div class="card crm-card">
    <div class="card-body">
      <div id="crm-calendar"></div>
    </div>
  </div>
{% endblock %}

{% block extra_css %}
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" rel="stylesheet">
{% endblock %}

{% block extra_js %}
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const calendarEl = document.getElementById('crm-calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        height: 'auto',
        events: '{% url "crm:reservation_events_api" %}',
        eventClick: function(info) {
          if (info.event.url) {
            info.jsEvent.preventDefault();
            window.location.href = info.event.url;
          }
        }
      });
      calendar.render();
    });
  </script>
{% endblock %}
